import{_ as b,u as w,a as x,r as _,b as C,c as l,o as L,d as U,e as r,f as o,w as s,g as z,h as B,t as E,E as d}from"./index-8958ea61.js";import{a as F}from"./axios-edfcd65b.js";const g=F.create({baseURL:"/api",timeout:15e3,withCredentials:!0,headers:{"Content-Type":"application/json;charset=UTF-8"}});g.interceptors.response.use(a=>a.data,a=>Promise.reject(a));const N={class:"login-container"},S={class:"login-card"},T={__name:"Login",setup(a){const f=w(),v=x(),m=_(),n=_(!1),t=C({username:"",nickname:""}),h={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}]},y=async()=>{var i;try{await((i=m.value)==null?void 0:i.validate()),n.value=!0;const e=await g.post("/users/login",t);e&&e.success?(v.setUser(e.data),d.success("登录成功"),f.push("/home")):d.error((e==null?void 0:e.message)||"登录失败")}catch{d.error("登录失败，请重试")}finally{n.value=!1}};return(i,e)=>{const p=l("el-input"),u=l("el-form-item"),k=l("el-button"),V=l("el-form");return L(),U("div",N,[r("div",S,[e[3]||(e[3]=r("div",{class:"login-header"},[r("h2",null,"统一登录"),r("p",null,"登录后进入门户主页选择功能")],-1)),o(V,{ref_key:"loginForm",ref:m,model:t,rules:h,onSubmit:e[2]||(e[2]=z(()=>{},["prevent"]))},{default:s(()=>[o(u,{prop:"username"},{default:s(()=>[o(p,{modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=c=>t.username=c),placeholder:"用户名",size:"large"},null,8,["modelValue"])]),_:1}),o(u,{prop:"nickname"},{default:s(()=>[o(p,{modelValue:t.nickname,"onUpdate:modelValue":e[1]||(e[1]=c=>t.nickname=c),placeholder:"昵称",size:"large"},null,8,["modelValue"])]),_:1}),o(u,null,{default:s(()=>[o(k,{type:"primary",size:"large",loading:n.value,onClick:y,style:{width:"100%"}},{default:s(()=>[B(E(n.value?"登录中…":"登录"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}},M=b(T,[["__scopeId","data-v-4cd946e8"]]);export{M as default};
